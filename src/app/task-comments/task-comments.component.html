<mat-card-content *ngIf="newCommentFormModel">
  <form #newCommentForm="ngForm" (ngSubmit)="onNewCommentFormSubmit()">
    <mat-form-field>
      <label>
          <textarea matInput
                    id="new_comment"
                    name="newComment"
                    [(ngModel)]="newCommentFormModel.commentText"
                    (keyup)="onNewCommentInputKeyUp()"
                    (keydown)="onNewCommentInputKeyDown($event)"
                    placeholder="{{ 'leave_comment' | translate }}"
                    maxlength="10000">
          </textarea>
      </label>
    </mat-form-field>

    <div>
      <button mat-raised-button type="submit" color="primary" [disabled]="!newCommentFormEnabled">
        {{ 'post' | translate }}
      </button>
    </div>
  </form>
</mat-card-content>

<div *ngIf="comments" infiniteScroll [infiniteScrollDistance]="1" (scrolled)="onCommentListScroll()">
  <mat-card-content *ngFor="let comment of comments" [className]="'comment-' + comment.id">
    <div class="divider-wrapper">
      <mat-divider></mat-divider>
    </div>

    <div class="comment-wrapper" (mouseover)="onCommentContainerMouseOver(comment)"
         (mouseout)="onCommentContainerMouseOut(comment)">
      <div class="comment-header">
        <div class="comment-date-wrapper">
          <span class="comment-date">{{ getRelativeCommentDate(comment) }}</span>
        </div>

        <div class="header-buttons" [hidden]="comment.id !== selectedComment?.id">
          <a mat-mini-fab class="mat-micro-fab" color="primary" aria-label="Edit comment button"
             (click)="onEditCommentButtonClick(comment)">
            <mat-icon class="edit-icon" [inline]="false">edit_circle_outline</mat-icon>
          </a>

          <a mat-mini-fab class="mat-micro-fab" color="warn" aria-label="Delete comment button"
             (click)="onDeleteCommentButtonClick(comment)">
            <mat-icon class="delete-icon" [inline]="false">delete_circle_outline</mat-icon>
          </a>
        </div>
      </div>

      <div class="comment-body">
        <form *ngIf="editCommentFormModel?.id == comment.id" (ngSubmit)="onEditCommentFormSubmit()">
          <mat-form-field>
            <label>
                <textarea matInput
                          id="edit_comment"
                          name="editComment"
                          (keyup)="onEditCommentInputKeyUp()"
                          [(ngModel)]="editCommentFormModel.commentText"
                          maxlength="10000">
                </textarea>
            </label>
          </mat-form-field>

          <div class="form-buttons">
            <button mat-raised-button type="submit" color="primary" [disabled]="!editCommentFormEnabled">
              {{ 'post' | translate }}
            </button>

            <button mat-raised-button (click)="onCancelEditCommentButtonClick()">
              {{ 'cancel' | translate }}
            </button>
          </div>
        </form>

        <span *ngIf="editCommentFormModel?.id != comment.id" class="comment-text">{{ comment.commentText }}</span>
      </div>
    </div>
  </mat-card-content>
</div>
